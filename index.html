<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Series of JavaScript tasks to improve Vanilla JS skills" />

    <title>JavaScript Katas</title>

    <link rel="shortcut icon" type="image/x-icon" href="./assets/js.png" />
    <link rel="stylesheet" href="./index.css" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="JavaScript Katas" />
    <meta property="og:description" content="Series of JavaScript tasks to improve my Vanilla JS skills" />
    <meta property="og:url" content="https://jakub-horacek.github.io/js-katas/" />
    <meta property="og:image" content="https://raw.githubusercontent.com/Jakub-Horacek/js-katas/main/assets/previews/kata-select.png" />
    <meta property="og:image:width" content="1191" />
    <meta property="og:image:height" content="932" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:title" content="JavaScript Katas" />
    <meta property="twitter:description" content="Series of JavaScript tasks to improve my Vanilla JS skills" />
    <meta property="twitter:image" content="https://raw.githubusercontent.com/Jakub-Horacek/js-katas/main/assets/previews/kata-select.png" />
  </head>
  <body>
    <header class="header">
      <h1 class="header__title">JavaScript Katas</h1>
      <p class="header__subtitle">A collection of JavaScript projects designed to enhance my Vanilla JS expertise through hands-on practice.</p>
    </header>

    <main class="main">
      <section class="katas" role="grid" aria-label="JavaScript Katas" id="katas-container">
        <!-- Kata cards will be dynamically generated here -->
      </section>
    </main>

    <aside class="legend" role="complementary" aria-label="Legend">
      <h3 class="legend__title">Legend</h3>
      <ul class="legend__list">
        <li class="legend__item legend__item--recommended">
          <span class="legend__icon" aria-hidden="true">‚≠ê</span>
          <span class="legend__text">Recommended</span>
        </li>
        <li class="legend__item legend__item--mobile">
          <span class="legend__icon" aria-hidden="true">üì±</span>
          <span class="legend__text">Mobile optimized</span>
        </li>
        <li class="legend__item legend__item--desktop">
          <span class="legend__icon" aria-hidden="true">üñ•Ô∏è</span>
          <span class="legend__text">Desktop optimized</span>
        </li>
        <li class="legend__item legend__item--wip">
          <span class="legend__icon" aria-hidden="true">üöß</span>
          <span class="legend__text">Work in progress</span>
        </li>
      </ul>
    </aside>

    <footer class="footer">
      <div class="footer__content">
        <div class="footer__author">
          <img class="footer__avatar" src="./assets/hillman-memoji.png" alt="Hillman Memoji" width="60" height="60" />
          <div class="footer__info">
            <a href="https://callmehillman.com" class="footer__link" target="_blank" rel="noopener noreferrer">
              Jakub Hor√°ƒçek
            </a>
            <span class="footer__copyright" id="current-year"></span>
          </div>
        </div>
        <a href="https://github.com/Jakub-Horacek/js-katas" class="footer__github" target="_blank" rel="noopener noreferrer" aria-label="View source code on GitHub">
          <img src="./assets/github.png" alt="GitHub" width="24" height="24" />
          <span class="footer__github-text">View Code</span>
        </a>
      </div>
    </footer>

    <script>
      // Set current year
      document.getElementById("current-year").textContent = new Date().getFullYear();

      // Load and render katas
      async function loadKatas() {
        try {
          const response = await fetch('./katas.json');
          const data = await response.json();
          renderKatas(data);
        } catch (error) {
          console.error('Error loading katas:', error);
          // Fallback: show error message
          document.getElementById('katas-container').innerHTML = 
            '<p style="text-align: center; color: var(--color-text-secondary);">Unable to load katas. Please refresh the page.</p>';
        }
      }

      function renderKatas(data) {
        const container = document.getElementById('katas-container');
        const { katas, badges } = data;

        // Generate kata cards
        const kataCards = katas.map(kata => {
          const cardClasses = ['kata-card'];
          if (kata.recommended) cardClasses.push('kata-card--recommended');

          // Generate device badges
          const deviceBadges = kata.badges.map(badgeType => {
            const badge = badges[badgeType];
            return `<div class="kata-card__badge kata-card__badge--${badgeType}" aria-label="${badge.label}">${badge.icon}</div>`;
          }).join('');

          // Add recommended badge if needed
          const recommendedBadge = kata.recommended ? 
            `<div class="kata-card__badge" aria-label="${badges.recommended.label}">${badges.recommended.icon}</div>` : '';

          const badgeElements = deviceBadges + recommendedBadge;

          return `
            <article class="${cardClasses.join(' ')}" role="gridcell">
              <a href="${kata.href}" class="kata-card__link" aria-label="${kata.title} - ${kata.description}">
                <div class="kata-card__image-container">
                  <img class="kata-card__image" src="${kata.image}" alt="${kata.title} preview" loading="lazy" />
                  ${badgeElements}
                </div>
                <div class="kata-card__content">
                  <h3 class="kata-card__title">${kata.title}</h3>
                  <p class="kata-card__description">${kata.description}</p>
                </div>
              </a>
            </article>
          `;
        }).join('');

        // Add "Coming Soon" card
        const comingSoonCard = `
          <article class="kata-card kata-card--coming-soon" role="gridcell">
            <div class="kata-card__link kata-card__link--disabled" aria-label="Coming soon">
              <div class="kata-card__image-container">
                <div class="kata-card__placeholder">
                  <span class="kata-card__placeholder-icon">üöÄ</span>
                </div>
              </div>
              <div class="kata-card__content">
                <h3 class="kata-card__title">Coming Soon</h3>
                <p class="kata-card__description">More katas on the way</p>
              </div>
            </div>
          </article>
        `;

        container.innerHTML = kataCards + comingSoonCard;
      }

      // Load katas when DOM is ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadKatas);
      } else {
        loadKatas();
      }
    </script>
  </body>
</html>
